(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=t(o);fetch(o.href,n)}})();var Ss={};let Oe;const Rs=new Uint8Array(16);function Ds(){if(!Oe&&(Oe=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Oe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Oe(Rs)}const V=[];for(let a=0;a<256;++a)V.push((a+256).toString(16).slice(1));function Ls(a,e=0){return V[a[e+0]]+V[a[e+1]]+V[a[e+2]]+V[a[e+3]]+"-"+V[a[e+4]]+V[a[e+5]]+"-"+V[a[e+6]]+V[a[e+7]]+"-"+V[a[e+8]]+V[a[e+9]]+"-"+V[a[e+10]]+V[a[e+11]]+V[a[e+12]]+V[a[e+13]]+V[a[e+14]]+V[a[e+15]]}const Os=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var Gt={randomUUID:Os};function Ft(a,e,t){if(Gt.randomUUID&&!a)return Gt.randomUUID();a=a||{};const s=a.random||(a.rng||Ds)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,Ls(s)}const Ht="current";function _(a){if(!a.isConnected)throw new Error("You cannot call this API before having established a connection to the host!")}function Is(a){return!!a?.data?.meta?.messageId}const Cs=5e3,xs=3e4,Ps=5e3;function Ns(a){return a.type==="connect"?Cs:a.type==="api"?xs:a.type==="navigateTo"?Ps:null}class ks{onDataUpdate;onBroadcast;onLivereload;pendingMessages=new Map;targetOrigin="*";constructor({onDataUpdate:e,onBroadcast:t,onLivereload:s}={}){this.onDataUpdate=e,this.onBroadcast=t,this.onLivereload=s,window.addEventListener("message",this.handleMessageWrapper)}destroy(){window.removeEventListener("message",this.handleMessageWrapper)}setOrigin(e){this.targetOrigin=e}sendUnidirectionalMessage(e){const t=Ft(),s={message:e,meta:{messageId:t,version:Ht}};window.parent.postMessage(s,this.targetOrigin)}async postMessage(e){return new Promise((t,s)=>{const o=Ft();let n;const r=Ns(e);r!==null&&(n=setTimeout(()=>{s(new Error(`Waiting for response from foundry host for "${e.type}" message (ID: ${o}) timed out after ${r}ms`))},r)),this.pendingMessages.set(o,g=>{n&&clearTimeout(n),t(g)});const p={message:e,meta:{messageId:o,version:Ht}};window.parent.postMessage(p,this.targetOrigin)})}handleMessageWrapper=e=>this.handleMessage(e);handleMessage=e=>{if(!Is(e))return;const{message:t}=e.data;if(t.type==="data"){this.onDataUpdate?.(t);return}if(t.type==="broadcast"){this.onBroadcast?.(t);return}if(t.type==="livereload"){this.onLivereload?.(t);return}const{messageId:s}=e.data.meta,o=this.pendingMessages.get(s);if(!o){this.throwError("Received unexpected message");return}this.pendingMessages.delete(s),o(t.payload)};throwError(e){throw new Error(e)}}function x(a,e,t,s){var o=arguments.length,n=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(a,e,t,s);else for(var p=a.length-1;p>=0;p--)(r=a[p])&&(n=(o<3?r(n):o>3?r(e,t,n):r(e,t))||n);return o>3&&n&&Object.defineProperty(e,t,n),n}const K=new WeakMap,Z=new WeakMap,q=new WeakMap,ke=Symbol("anyProducer"),Bt=Promise.resolve(),Ue=Symbol("listenerAdded"),Ge=Symbol("listenerRemoved");let Fe=!1,it=!1;const He=a=>typeof a=="string"||typeof a=="symbol"||typeof a=="number";function pe(a){if(!He(a))throw new TypeError("`eventName` must be a string, symbol, or number")}function Ie(a){if(typeof a!="function")throw new TypeError("listener must be a function")}function le(a,e){const t=Z.get(a);if(t.has(e))return t.get(e)}function we(a,e){const t=He(e)?e:ke,s=q.get(a);if(s.has(t))return s.get(t)}function Us(a,e,t){const s=q.get(a);if(s.has(e))for(const o of s.get(e))o.enqueue(t);if(s.has(ke)){const o=Promise.all([e,t]);for(const n of s.get(ke))n.enqueue(o)}}function zt(a,e){e=Array.isArray(e)?e:[e];let t=!1,s=()=>{},o=[];const n={enqueue(r){o.push(r),s()},finish(){t=!0,s()}};for(const r of e){let p=we(a,r);p||(p=new Set,q.get(a).set(r,p)),p.add(n)}return{async next(){return o?o.length===0?t?(o=void 0,this.next()):(await new Promise(r=>{s=r}),this.next()):{done:!1,value:await o.shift()}:{done:!0}},async return(r){o=void 0;for(const p of e){const g=we(a,p);g&&(g.delete(n),g.size===0&&q.get(a).delete(p))}return s(),arguments.length>0?{done:!0,value:await r}:{done:!0}},[Symbol.asyncIterator](){return this}}}function jt(a){if(a===void 0)return Wt;if(!Array.isArray(a))throw new TypeError("`methodNames` must be an array of strings");for(const e of a)if(!Wt.includes(e))throw typeof e!="string"?new TypeError("`methodNames` element must be a string"):new Error(`${e} is not Emittery method`);return a}const de=a=>a===Ue||a===Ge;function Ce(a,e,t){if(de(e))try{Fe=!0,a.emit(e,t)}finally{Fe=!1}}class te{static mixin(e,t){return t=jt(t),s=>{if(typeof s!="function")throw new TypeError("`target` must be function");for(const r of t)if(s.prototype[r]!==void 0)throw new Error(`The property \`${r}\` already exists on \`target\``);function o(){return Object.defineProperty(this,e,{enumerable:!1,value:new te}),this[e]}Object.defineProperty(s.prototype,e,{enumerable:!1,get:o});const n=r=>function(...p){return this[e][r](...p)};for(const r of t)Object.defineProperty(s.prototype,r,{enumerable:!1,value:n(r)});return s}}static get isDebugEnabled(){if(typeof Ss!="object")return it;const{env:e}=globalThis.process??{env:{}};return e.DEBUG==="emittery"||e.DEBUG==="*"||it}static set isDebugEnabled(e){it=e}constructor(e={}){K.set(this,new Set),Z.set(this,new Map),q.set(this,new Map),q.get(this).set(ke,new Set),this.debug=e.debug??{},this.debug.enabled===void 0&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(t,s,o,n)=>{try{n=JSON.stringify(n)}catch{n=`Object with the following keys failed to stringify: ${Object.keys(n).join(",")}`}(typeof o=="symbol"||typeof o=="number")&&(o=o.toString());const r=new Date,p=`${r.getHours()}:${r.getMinutes()}:${r.getSeconds()}.${r.getMilliseconds()}`;console.log(`[${p}][emittery:${t}][${s}] Event Name: ${o}
	data: ${n}`)})}logIfDebugEnabled(e,t,s){(te.isDebugEnabled||this.debug.enabled)&&this.debug.logger(e,this.debug.name,t,s)}on(e,t){Ie(t),e=Array.isArray(e)?e:[e];for(const s of e){pe(s);let o=le(this,s);o||(o=new Set,Z.get(this).set(s,o)),o.add(t),this.logIfDebugEnabled("subscribe",s,void 0),de(s)||Ce(this,Ue,{eventName:s,listener:t})}return this.off.bind(this,e,t)}off(e,t){Ie(t),e=Array.isArray(e)?e:[e];for(const s of e){pe(s);const o=le(this,s);o&&(o.delete(t),o.size===0&&Z.get(this).delete(s)),this.logIfDebugEnabled("unsubscribe",s,void 0),de(s)||Ce(this,Ge,{eventName:s,listener:t})}}once(e){let t;const s=new Promise(o=>{t=this.on(e,n=>{t(),o(n)})});return s.off=t,s}events(e){e=Array.isArray(e)?e:[e];for(const t of e)pe(t);return zt(this,e)}async emit(e,t){if(pe(e),de(e)&&!Fe)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emit",e,t),Us(this,e,t);const s=le(this,e)??new Set,o=K.get(this),n=[...s],r=de(e)?[]:[...o];await Bt,await Promise.all([...n.map(async p=>{if(s.has(p))return p(t)}),...r.map(async p=>{if(o.has(p))return p(e,t)})])}async emitSerial(e,t){if(pe(e),de(e)&&!Fe)throw new TypeError("`eventName` cannot be meta event `listenerAdded` or `listenerRemoved`");this.logIfDebugEnabled("emitSerial",e,t);const s=le(this,e)??new Set,o=K.get(this),n=[...s],r=[...o];await Bt;for(const p of n)s.has(p)&&await p(t);for(const p of r)o.has(p)&&await p(e,t)}onAny(e){return Ie(e),this.logIfDebugEnabled("subscribeAny",void 0,void 0),K.get(this).add(e),Ce(this,Ue,{listener:e}),this.offAny.bind(this,e)}anyEvent(){return zt(this)}offAny(e){Ie(e),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),Ce(this,Ge,{listener:e}),K.get(this).delete(e)}clearListeners(e){e=Array.isArray(e)?e:[e];for(const t of e)if(this.logIfDebugEnabled("clear",t,void 0),He(t)){const s=le(this,t);s&&s.clear();const o=we(this,t);if(o){for(const n of o)n.finish();o.clear()}}else{K.get(this).clear();for(const[s,o]of Z.get(this).entries())o.clear(),Z.get(this).delete(s);for(const[s,o]of q.get(this).entries()){for(const n of o)n.finish();o.clear(),q.get(this).delete(s)}}}listenerCount(e){e=Array.isArray(e)?e:[e];let t=0;for(const s of e){if(He(s)){t+=K.get(this).size+(le(this,s)?.size??0)+(we(this,s)?.size??0)+(we(this)?.size??0);continue}s!==void 0&&pe(s),t+=K.get(this).size;for(const o of Z.get(this).values())t+=o.size;for(const o of q.get(this).values())t+=o.size}return t}bindMethods(e,t){if(typeof e!="object"||e===null)throw new TypeError("`target` must be an object");t=jt(t);for(const s of t){if(e[s]!==void 0)throw new Error(`The property \`${s}\` already exists on \`target\``);Object.defineProperty(e,s,{enumerable:!1,value:this[s].bind(this)})}}}const Wt=Object.getOwnPropertyNames(te.prototype).filter(a=>a!=="constructor");Object.defineProperty(te,"listenerAdded",{value:Ue,writable:!1,enumerable:!0,configurable:!1});Object.defineProperty(te,"listenerRemoved",{value:Ge,writable:!1,enumerable:!0,configurable:!1});function P(a){let e,t,s;return e=a,(o,n,r)=>{if(r.value!=null)r.value=Qt(r.value,e,t,s);else if(r.get!=null)r.get=Qt(r.get,e,t,s);else throw"Only put a Memoize() decorator on a method or get accessor."}}const at=new Map;function Qt(a,e,t=0,s){const o=Symbol("__memoized_map__");return function(...n){let r;this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:new Map});let p=this[o];if(Array.isArray(s))for(const g of s)at.has(g)?at.get(g).push(p):at.set(g,[p]);if(e||n.length>0||t>0){let g;e===!0?g=n.map(h=>h.toString()).join("!"):e?g=e.apply(this,n):g=n[0];const m=`${g}__timestamp`;let f=!1;if(t>0)if(!p.has(m))f=!0;else{let h=p.get(m);f=Date.now()-h>t}p.has(g)&&!f?r=p.get(g):(r=a.apply(this,n),p.set(g,r),t>0&&p.set(m,Date.now()))}else{const g=this;p.has(g)?r=p.get(g):(r=a.apply(this,n),p.set(g,r))}return r}}class Gs{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async deleteEntitiesSuppressedDevicesV1(e={}){const t={type:"api",api:"alerts",method:"deleteEntitiesSuppressedDevicesV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesAlertsV1(e={}){console.warn("This method is deprecated. Use getQueriesAlertsV2 instead.");const t={type:"api",api:"alerts",method:"getQueriesAlertsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesAlertsV2(e={}){const t={type:"api",api:"alerts",method:"getQueriesAlertsV2",payload:{params:e}};return this.bridge.postMessage(t)}async patchCombinedAlertsV2(e,t={}){console.warn("This method is deprecated. Use patchCombinedAlertsV3 instead.");const s={type:"api",api:"alerts",method:"patchCombinedAlertsV2",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async patchCombinedAlertsV3(e,t={}){const s={type:"api",api:"alerts",method:"patchCombinedAlertsV3",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async patchEntitiesAlertsV2(e,t={}){console.warn("This method is deprecated. Use patchEntitiesAlertsV3 instead.");const s={type:"api",api:"alerts",method:"patchEntitiesAlertsV2",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async patchEntitiesAlertsV3(e,t={}){const s={type:"api",api:"alerts",method:"patchEntitiesAlertsV3",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async patchEntitiesSuppressedDevicesV1(e,t={}){const s={type:"api",api:"alerts",method:"patchEntitiesSuppressedDevicesV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postAggregatesAlertsV1(e,t={}){console.warn("This method is deprecated. Use postAggregatesAlertsV2 instead.");const s={type:"api",api:"alerts",method:"postAggregatesAlertsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postAggregatesAlertsV2(e,t={}){const s={type:"api",api:"alerts",method:"postAggregatesAlertsV2",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesAlertsV1(e,t={}){console.warn("This method is deprecated. Use postEntitiesAlertsV2 instead.");const s={type:"api",api:"alerts",method:"postEntitiesAlertsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesAlertsV2(e,t={}){const s={type:"api",api:"alerts",method:"postEntitiesAlertsV2",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesSuppressedDevicesV1(e,t={}){const s={type:"api",api:"alerts",method:"postEntitiesSuppressedDevicesV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class Fs{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async deleteV1CollectionsCollectionNameObjectsObjectKey(e={}){const t={type:"api",api:"customobjects",method:"deleteV1CollectionsCollectionNameObjectsObjectKey",payload:{params:e}};return this.bridge.postMessage(t)}async getV1Collections(e={}){const t={type:"api",api:"customobjects",method:"getV1Collections",payload:{params:e}};return this.bridge.postMessage(t)}async getV1CollectionsCollectionNameObjects(e={}){const t={type:"api",api:"customobjects",method:"getV1CollectionsCollectionNameObjects",payload:{params:e}};return this.bridge.postMessage(t)}async getV1CollectionsCollectionNameObjectsObjectKey(e={}){const t={type:"api",api:"customobjects",method:"getV1CollectionsCollectionNameObjectsObjectKey",payload:{params:e}};return this.bridge.postMessage(t)}async getV1CollectionsCollectionNameObjectsObjectKeyMetadata(e={}){const t={type:"api",api:"customobjects",method:"getV1CollectionsCollectionNameObjectsObjectKeyMetadata",payload:{params:e}};return this.bridge.postMessage(t)}async postV1CollectionsCollectionNameObjects(e,t={}){const s={type:"api",api:"customobjects",method:"postV1CollectionsCollectionNameObjects",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async putV1CollectionsCollectionNameObjectsObjectKey(e,t={}){const s={type:"api",api:"customobjects",method:"putV1CollectionsCollectionNameObjectsObjectKey",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class Hs{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async getEntitiesSuppressedDevicesV1(e={}){const t={type:"api",api:"detects",method:"getEntitiesSuppressedDevicesV1",payload:{params:e}};return this.bridge.postMessage(t)}async patchEntitiesDetectsV2(e,t={}){const s={type:"api",api:"detects",method:"patchEntitiesDetectsV2",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async patchQueriesDetectsV1(e,t={}){const s={type:"api",api:"detects",method:"patchQueriesDetectsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async patchQueriesDetectsV2(e,t={}){const s={type:"api",api:"detects",method:"patchQueriesDetectsV2",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postAggregatesDetectsGetV1(e,t={}){const s={type:"api",api:"detects",method:"postAggregatesDetectsGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesSummariesGetV1(e,t={}){const s={type:"api",api:"detects",method:"postEntitiesSummariesGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesSuppressedDevicesV1(e,t={}){const s={type:"api",api:"detects",method:"postEntitiesSuppressedDevicesV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class Bs{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async deleteEntitiesGroupsV1(e){const t={type:"api",api:"devices",method:"deleteEntitiesGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getAggregatesBucketsV1(e){const t={type:"api",api:"devices",method:"getAggregatesBucketsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getAggregatesFgaTagPrefixCountsV1(e){const t={type:"api",api:"devices",method:"getAggregatesFgaTagPrefixCountsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getAggregatesTagPrefixCountsV1(e){const t={type:"api",api:"devices",method:"getAggregatesTagPrefixCountsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesFgaGroupsV1(e){const t={type:"api",api:"devices",method:"getEntitiesFgaGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesGroupsV1(e){const t={type:"api",api:"devices",method:"getEntitiesGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesAvailableGroupsV1(e={}){const t={type:"api",api:"devices",method:"getQueriesAvailableGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesDevicesHiddenV2(e={}){const t={type:"api",api:"devices",method:"getQueriesDevicesHiddenV2",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesDevicesV1(e={}){const t={type:"api",api:"devices",method:"getQueriesDevicesV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesDevicesV2(e={}){const t={type:"api",api:"devices",method:"getQueriesDevicesV2",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesFgaGroupsV1(e={}){const t={type:"api",api:"devices",method:"getQueriesFgaGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesGroupsV1(e={}){const t={type:"api",api:"devices",method:"getQueriesGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async patchEntitiesDevicesTagsV2(e,t={}){const s={type:"api",api:"devices",method:"patchEntitiesDevicesTagsV2",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async patchEntitiesGroupsV1(e,t={}){const s={type:"api",api:"devices",method:"patchEntitiesGroupsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postAggregatesDevicesGetV1(e,t={}){const s={type:"api",api:"devices",method:"postAggregatesDevicesGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postAggregatesFgaHostsGetV1(e,t={}){const s={type:"api",api:"devices",method:"postAggregatesFgaHostsGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postCombinedDevicesLoginHistoryV1(e,t={}){const s={type:"api",api:"devices",method:"postCombinedDevicesLoginHistoryV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postCombinedFgaHostsLoginHistoryV1(e,t={}){const s={type:"api",api:"devices",method:"postCombinedFgaHostsLoginHistoryV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesDevicesActionsV4(e,t={}){const s={type:"api",api:"devices",method:"postEntitiesDevicesActionsV4",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesDevicesHiddenActionsV4(e,t={}){const s={type:"api",api:"devices",method:"postEntitiesDevicesHiddenActionsV4",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesDevicesReportsV1(e,t={}){const s={type:"api",api:"devices",method:"postEntitiesDevicesReportsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesDevicesV2(e,t={}){const s={type:"api",api:"devices",method:"postEntitiesDevicesV2",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesFgaHostsReportsV1(e,t={}){const s={type:"api",api:"devices",method:"postEntitiesFgaHostsReportsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesFgaHostsV1(e,t={}){const s={type:"api",api:"devices",method:"postEntitiesFgaHostsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesGroupActionsV1(e,t){const s={type:"api",api:"devices",method:"postEntitiesGroupActionsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesGroupsV1(e,t={}){const s={type:"api",api:"devices",method:"postEntitiesGroupsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class zs{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async getEntitiesExecutionV1(e){const t={type:"api",api:"faasGateway",method:"getEntitiesExecutionV1",payload:{params:e}};return this.bridge.postMessage(t)}async postEntitiesExecutionV1(e,t={}){const s={type:"api",api:"faasGateway",method:"postEntitiesExecutionV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class js{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async deleteEntitiesNetworkLocationsV1(e){const t={type:"api",api:"fwmgr",method:"deleteEntitiesNetworkLocationsV1",payload:{params:e}};return this.bridge.postMessage(t)}async deleteEntitiesPoliciesV1(e){const t={type:"api",api:"fwmgr",method:"deleteEntitiesPoliciesV1",payload:{params:e}};return this.bridge.postMessage(t)}async deleteEntitiesRuleGroupsV1(e){const t={type:"api",api:"fwmgr",method:"deleteEntitiesRuleGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesEventsV1(e){const t={type:"api",api:"fwmgr",method:"getEntitiesEventsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesFirewallFieldsV1(e){const t={type:"api",api:"fwmgr",method:"getEntitiesFirewallFieldsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesNetworkLocationsDetailsV1(e){const t={type:"api",api:"fwmgr",method:"getEntitiesNetworkLocationsDetailsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesNetworkLocationsV1(e){const t={type:"api",api:"fwmgr",method:"getEntitiesNetworkLocationsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesPlatformsV1(e){const t={type:"api",api:"fwmgr",method:"getEntitiesPlatformsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesPoliciesV1(e){const t={type:"api",api:"fwmgr",method:"getEntitiesPoliciesV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesRuleGroupsV1(e){const t={type:"api",api:"fwmgr",method:"getEntitiesRuleGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesRulesV1(e){const t={type:"api",api:"fwmgr",method:"getEntitiesRulesV1",payload:{params:e}};return this.bridge.postMessage(t)}async getLibraryEntitiesRuleGroupsV1(e){const t={type:"api",api:"fwmgr",method:"getLibraryEntitiesRuleGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getLibraryQueriesRuleGroupsV1(e={}){const t={type:"api",api:"fwmgr",method:"getLibraryQueriesRuleGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesEventsV1(e={}){const t={type:"api",api:"fwmgr",method:"getQueriesEventsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesFirewallFieldsV1(e={}){const t={type:"api",api:"fwmgr",method:"getQueriesFirewallFieldsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesNetworkLocationsV1(e={}){const t={type:"api",api:"fwmgr",method:"getQueriesNetworkLocationsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesPlatformsV1(e={}){const t={type:"api",api:"fwmgr",method:"getQueriesPlatformsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesPolicyRulesV1(e={}){const t={type:"api",api:"fwmgr",method:"getQueriesPolicyRulesV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesRuleGroupsV1(e={}){const t={type:"api",api:"fwmgr",method:"getQueriesRuleGroupsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesRulesV1(e={}){const t={type:"api",api:"fwmgr",method:"getQueriesRulesV1",payload:{params:e}};return this.bridge.postMessage(t)}async patchEntitiesNetworkLocationsV1(e,t={}){const s={type:"api",api:"fwmgr",method:"patchEntitiesNetworkLocationsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async patchEntitiesRuleGroupsV1(e,t={}){const s={type:"api",api:"fwmgr",method:"patchEntitiesRuleGroupsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postAggregatesEventsGetV1(e,t={}){const s={type:"api",api:"fwmgr",method:"postAggregatesEventsGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postAggregatesPolicyRulesGetV1(e,t={}){const s={type:"api",api:"fwmgr",method:"postAggregatesPolicyRulesGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postAggregatesRuleGroupsGetV1(e,t={}){const s={type:"api",api:"fwmgr",method:"postAggregatesRuleGroupsGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postAggregatesRulesGetV1(e,t={}){const s={type:"api",api:"fwmgr",method:"postAggregatesRulesGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesNetworkLocationsMetadataV1(e,t={}){const s={type:"api",api:"fwmgr",method:"postEntitiesNetworkLocationsMetadataV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesNetworkLocationsPrecedenceV1(e,t={}){const s={type:"api",api:"fwmgr",method:"postEntitiesNetworkLocationsPrecedenceV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesNetworkLocationsV1(e,t={}){const s={type:"api",api:"fwmgr",method:"postEntitiesNetworkLocationsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesOntologyV1(e,t={}){const s={type:"api",api:"fwmgr",method:"postEntitiesOntologyV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesRuleGroupsV1(e,t={}){const s={type:"api",api:"fwmgr",method:"postEntitiesRuleGroupsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesRulesValidateFilepathV1(e,t={}){const s={type:"api",api:"fwmgr",method:"postEntitiesRulesValidateFilepathV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async putEntitiesNetworkLocationsV1(e,t={}){const s={type:"api",api:"fwmgr",method:"putEntitiesNetworkLocationsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async putEntitiesPoliciesV2(e,t={}){const s={type:"api",api:"fwmgr",method:"putEntitiesPoliciesV2",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class Ws{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async getCombinedCrowdscoresV1(e={}){const t={type:"api",api:"incidents",method:"getCombinedCrowdscoresV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesBehaviorsV1(e={}){const t={type:"api",api:"incidents",method:"getQueriesBehaviorsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesIncidentsV1(e={}){const t={type:"api",api:"incidents",method:"getQueriesIncidentsV1",payload:{params:e}};return this.bridge.postMessage(t)}async postAggregatesBehaviorsGetV1(e,t={}){const s={type:"api",api:"incidents",method:"postAggregatesBehaviorsGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postAggregatesIncidentsGetV1(e,t={}){const s={type:"api",api:"incidents",method:"postAggregatesIncidentsGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesBehaviorsGetV1(e,t={}){const s={type:"api",api:"incidents",method:"postEntitiesBehaviorsGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesIncidentActionsV1(e,t={}){const s={type:"api",api:"incidents",method:"postEntitiesIncidentActionsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesIncidentsGetV1(e,t={}){const s={type:"api",api:"incidents",method:"postEntitiesIncidentsGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class Qs{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async getEntitiesSavedSearchesExecuteV1(e){const t={type:"api",api:"loggingapi",method:"getEntitiesSavedSearchesExecuteV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesSavedSearchesV1(e){const t={type:"api",api:"loggingapi",method:"getEntitiesSavedSearchesV1",payload:{params:e}};return this.bridge.postMessage(t)}async postEntitiesSavedSearchesExecuteV1(e,t={}){const s={type:"api",api:"loggingapi",method:"postEntitiesSavedSearchesExecuteV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class $s{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async getIntelMitreEntitiesMatrixV1(e={}){const t={type:"api",api:"mitre",method:"getIntelMitreEntitiesMatrixV1",payload:{params:e}};return this.bridge.postMessage(t)}}class qs{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async getEntitiesConfigsV1(e={}){const t={type:"api",api:"plugins",method:"getEntitiesConfigsV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesDefinitionsV1(e){const t={type:"api",api:"plugins",method:"getEntitiesDefinitionsV1",payload:{params:e}};return this.bridge.postMessage(t)}async postEntitiesExecuteDraftV1(e,t={}){const s={type:"api",api:"plugins",method:"postEntitiesExecuteDraftV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesExecuteV1(e,t={}){const s={type:"api",api:"plugins",method:"postEntitiesExecuteV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class Ks{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async deleteEntitiesPutFilesV1(e){const t={type:"api",api:"remoteResponse",method:"deleteEntitiesPutFilesV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesAppCommandV1(e){const t={type:"api",api:"remoteResponse",method:"getEntitiesAppCommandV1",payload:{params:e}};return this.bridge.postMessage(t)}async getEntitiesPutFilesV2(e){const t={type:"api",api:"remoteResponse",method:"getEntitiesPutFilesV2",payload:{params:e}};return this.bridge.postMessage(t)}async getQueriesPutFilesV1(e={}){const t={type:"api",api:"remoteResponse",method:"getQueriesPutFilesV1",payload:{params:e}};return this.bridge.postMessage(t)}async postEntitiesAppCommandV1(e,t={}){const s={type:"api",api:"remoteResponse",method:"postEntitiesAppCommandV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesAppSessionsV1(e,t={}){const s={type:"api",api:"remoteResponse",method:"postEntitiesAppSessionsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class Ys{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async getQueriesUsersV1(e={}){const t={type:"api",api:"userManagement",method:"getQueriesUsersV1",payload:{params:e}};return this.bridge.postMessage(t)}async postEntitiesUsersGetV1(e,t={}){const s={type:"api",api:"userManagement",method:"postEntitiesUsersGetV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class Xs{bridge;constructor(e){this.bridge=e}getBridge(){return this.bridge}async getEntitiesExecutionResultsV1(e){const t={type:"api",api:"workflows",method:"getEntitiesExecutionResultsV1",payload:{params:e}};return this.bridge.postMessage(t)}async postEntitiesExecuteV1(e,t={}){const s={type:"api",api:"workflows",method:"postEntitiesExecuteV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}async postEntitiesExecutionActionsV1(e,t){const s={type:"api",api:"workflows",method:"postEntitiesExecutionActionsV1",payload:{body:e,params:t}};return this.bridge.postMessage(s)}}class U{api;constructor(e){this.api=e}get alerts(){return _(this.api),new Gs(this.api.bridge)}get detects(){return _(this.api),new Hs(this.api.bridge)}get devices(){return _(this.api),new Bs(this.api.bridge)}get fwmgr(){return _(this.api),new js(this.api.bridge)}get incidents(){return _(this.api),new Ws(this.api.bridge)}get mitre(){return _(this.api),new $s(this.api.bridge)}get plugins(){return _(this.api),new qs(this.api.bridge)}get remoteResponse(){return _(this.api),new Ks(this.api.bridge)}get userManagement(){return _(this.api),new Ys(this.api.bridge)}get workflows(){return _(this.api),new Xs(this.api.bridge)}get customobjects(){return _(this.api),new Fs(this.api.bridge)}get faasGateway(){return _(this.api),new zs(this.api.bridge)}get loggingapi(){return _(this.api),new Qs(this.api.bridge)}}x([P()],U.prototype,"alerts",null);x([P()],U.prototype,"detects",null);x([P()],U.prototype,"devices",null);x([P()],U.prototype,"fwmgr",null);x([P()],U.prototype,"incidents",null);x([P()],U.prototype,"mitre",null);x([P()],U.prototype,"plugins",null);x([P()],U.prototype,"remoteResponse",null);x([P()],U.prototype,"userManagement",null);x([P()],U.prototype,"workflows",null);x([P()],U.prototype,"customobjects",null);x([P()],U.prototype,"faasGateway",null);x([P()],U.prototype,"loggingapi",null);class Zs{falcon;definition;constructor(e,t){this.falcon=e,this.definition=t}async execute({request:e}={}){return this.falcon.api.plugins.postEntitiesExecuteV1({resources:[{definition_id:this.definition.definitionId,operation_id:this.definition.operationId,request:e}]})}}class J{falcon;definition;static GET="GET";static POST="POST";static PATCH="PATCH";static PUT="PUT";static DELETE="DELETE";pollTimeout=500;intervalId;constructor(e,t){this.falcon=e,this.definition=t}async execute({path:e,method:t,body:s,params:o}){const n="id"in this.definition?{function_id:this.definition.id,function_version:this.definition.version}:{function_name:this.definition.name,function_version:this.definition.version},r=await this.falcon.api.faasGateway.postEntitiesExecutionV1({...n,payload:{path:e,method:t,body:s,params:o}});return new Promise((p,g)=>{const m=r?.resources?.[0];m?.execution_id?this.pollForResult({resolve:p,reject:g,executionId:m?.execution_id}):g(r?.errors)})}async getExecutionResult(e){return(await this.falcon.api.faasGateway.getEntitiesExecutionV1({id:e}))?.resources?.[0]?.payload}pollForResult({resolve:e,reject:t,executionId:s}){let o=2;this.intervalId=window.setInterval(async()=>{try{const n=await this.getExecutionResult(s);n&&(window.clearInterval(this.intervalId),e(n))}catch(n){o<=0&&(window.clearInterval(this.intervalId),t(n)),o--}},this.pollTimeout)}path(e){const t=new URL(e,"http://localhost"),s=t.pathname,o=[...t.searchParams.entries()].reduce((n,[r,p])=>({...n,[r]:[p]}),{});return{path:s,queryParams:o,get:async(n={})=>this.get({path:s,params:{query:n?.query??o??{},header:n?.header??{}}}),post:async(n,r={})=>this.post({path:s,params:{query:r?.query??o??{},header:r?.header??{}},body:n}),patch:async(n,r={})=>this.patch({path:s,params:{query:r?.query??o??{},header:r?.header??{}},body:n}),put:async(n,r={})=>this.put({path:s,params:{query:r?.query??o??{},header:r?.header??{}},body:n}),delete:async(n,r={})=>this.delete({path:s,params:{query:r?.query??o??{},header:r?.header??{}},body:n})}}async get({path:e,params:t}){return this.execute({path:e,method:J.GET,params:t})}async post({path:e,params:t,body:s}){return this.execute({path:e,method:J.POST,body:s,params:t})}async patch({path:e,params:t,body:s}){return this.execute({path:e,method:J.PATCH,body:s,params:t})}async put({path:e,params:t,body:s}){return this.execute({path:e,method:J.PUT,body:s,params:t})}async delete({path:e,params:t,body:s}){return this.execute({path:e,method:J.DELETE,body:s,params:t})}destroy(){this.intervalId&&(window.clearInterval(this.intervalId),this.intervalId=void 0)}}class Js{falcon;definition;constructor(e,t){this.falcon=e,this.definition=t}async write(e,t){return this.falcon.bridge.postMessage({type:"collection",payload:{type:"write",key:e,collection:this.definition.collection,data:t}})}async read(e){return this.falcon.bridge.postMessage({type:"collection",payload:{type:"read",key:e,collection:this.definition.collection}})}async delete(e){return this.falcon.bridge.postMessage({type:"collection",payload:{type:"delete",key:e,collection:this.definition.collection}})}async search({filter:e,offset:t,sort:s,limit:o}){return this.falcon.bridge.postMessage({type:"collection",payload:{type:"search",filter:e,limit:o,offset:t,sort:s,collection:this.definition.collection}})}async list(e){return this.falcon.bridge.postMessage({type:"collection",payload:{type:"list",collection:this.definition.collection,start:e?.start,end:e?.end,limit:e?.limit}})}}class ei{falcon;constructor(e){this.falcon=e}async write(e,t){return this.falcon.bridge.postMessage({type:"loggingapi",payload:{type:"ingest",data:e,tag:t?.tag,tagSource:t?.tagSource,testData:t?.testData}})}async query(e){return this.falcon.bridge.postMessage({type:"loggingapi",payload:{type:"dynamic-execute",data:e}})}async savedQuery(e){return this.falcon.bridge.postMessage({type:"loggingapi",payload:{type:"saved-query-execute",data:e}})}}const ti=["_self","_blank"];class si{falcon;constructor(e){this.falcon=e}async navigateTo({path:e,type:t,target:s,metaKey:o,ctrlKey:n,shiftKey:r}){await this.falcon.bridge.postMessage({type:"navigateTo",payload:{path:e,type:t??"falcon",target:s??"_self",metaKey:o??!1,ctrlKey:n??!1,shiftKey:r??!1}})}async onClick(e,t="_self",s="falcon"){if(!(e instanceof Event))throw Error('"event" property should be subclass of Event');if(!("preventDefault"in e)||!(e.target instanceof HTMLAnchorElement))return;e.preventDefault();const o=e.target.getAttribute("href");t=e.target.getAttribute("target")??t;const n=e.target.dataset?.type??s;if(t===null||!ti.includes(t))throw new Error("Target should be _self or _blank");const r=t;if(o==null)throw new Error("Navigation path is missing. Make sure you have added navigation.onClick on the `a` tag and `href` is present.");const{metaKey:p,ctrlKey:g,shiftKey:m}=e;await this.navigateTo({path:o,type:n,target:r,metaKey:p,ctrlKey:g,shiftKey:m})}}class ii{bridge;observer;constructor(e){this.bridge=e,this.observer=new ResizeObserver(t=>this.handleResizeEvent(t)),this.observer.observe(document.body)}handleResizeEvent(e){const{height:t}=e[0].contentRect;this.bridge.sendUnidirectionalMessage({type:"resize",payload:{height:t}})}destroy(){this.observer.disconnect()}}class ai{bridge;constructor(e){this.bridge=e}async openModal(e,t,s={}){const o=await this.bridge.postMessage({type:"openModal",payload:{extension:e,title:t,options:s}});if(o instanceof Error)throw o;return o}closeModal(e){this.bridge.sendUnidirectionalMessage({type:"closeModal",payload:e})}async uploadFile(e,t){return this.bridge.postMessage({type:"fileUpload",fileUploadType:e,payload:t})}}class ut{isConnected=!1;events=new te;data;bridge=new ks({onDataUpdate:e=>this.handleDataUpdate(e),onBroadcast:e=>this.handleBroadcastMessage(e),onLivereload:()=>this.handleLivereloadMessage()});api=new U(this);ui=new ai(this.bridge);resizeTracker;cloudFunctions=[];apiIntegrations=[];collections=[];async connect(){const e=await this.bridge.postMessage({type:"connect"});if(e!==void 0){const{data:t,origin:s}=e;this.bridge.setOrigin(s),this.data=t,this.updateTheme(t?.theme),this.isConnected=!0}return this.resizeTracker=new ii(this.bridge),e}get appId(){return this.data?.app.id}sendBroadcast(e){this.bridge.sendUnidirectionalMessage({type:"broadcast",payload:e})}handleDataUpdate(e){this.data=e.payload,this.updateTheme(this.data.theme),this.events.emit("data",this.data)}handleBroadcastMessage(e){this.events.emit("broadcast",e.payload)}handleLivereloadMessage(){document.location.reload()}updateTheme(e){if(!e)return;const t=e==="theme-dark"?"theme-light":"theme-dark";document.documentElement.classList.add(e),document.documentElement.classList.remove(t)}cloudFunction(e){_(this);const t=new J(this,e);return this.cloudFunctions.push(t),t}apiIntegration({definitionId:e,operationId:t}){if(_(this),!this.data)throw Error("Data from console is missing");const s=new Zs(this,{operationId:t,definitionId:e});return this.apiIntegrations.push(s),s}collection({collection:e}){_(this);const t=new Js(this,{collection:e});return this.collections.push(t),t}get navigation(){return _(this),new si(this)}get logscale(){return _(this),new ei(this)}destroy(){this.cloudFunctions.forEach(e=>e.destroy()),this.resizeTracker?.destroy(),this.bridge.destroy()}}x([P()],ut.prototype,"navigation",null);x([P()],ut.prototype,"logscale",null);const ss=5e3,oi=6e4/ss,ni="translate-with-charlotte-ai",ri=async a=>{const e=new ut;e.events.on("data",p=>{a(p?.detectionId??p?.detection?.composite_id)}),await e.connect();const t=async p=>await r("PostEntitiesAlertsV2",{json:!0}).get({composite_ids:[p]}),s=async p=>{const g=e.collection({collection:"detection_context"}),m=await g.search({filter:`compositeId:'${p}'`});return(await Promise.all(m?.resources?.map(({object_key:h})=>g.read(h).then(A=>({...A,object_key:h}))))).filter(Boolean)},o=async p=>{const g=r("QueryCasesIdsByFilter"),m=r("QueryActivityByCaseID"),f=r("GetCaseActivityByIds",{json:!0}),h=await g.list({query:{filter:`case.detections.id:'${p}'`}}),E=(await Promise.all(h.map(G=>m.list({query:{case_id:G}})))).flat().filter(Boolean).filter(G=>typeof G=="string");return(E.length?await f.list({ids:E}):[]).filter(({type:G})=>G==="comment")},n=async({language:p,htmlContent:g,collectionEntry:m})=>{const f=await e.api.workflows.postEntitiesExecuteV1({language:p,htmlContent:g,...m},{name:ni,depth:0});if(f.errors?.length)throw Error(`${f?.errors[0].code} ${f.errors[0].message}`);const h=f?.resources?.[0],A=async()=>e.api.workflows.getEntitiesExecutionResultsV1({ids:h});let E=[],N=[{status:"In progress"}],G=0;for(;!E?.length&&N?.[0]?.status==="In progress";){if(G>=oi)throw new is;G++,await ci(),{errors:E,resources:N}=await A()}return Object.values(N?.[0]?.output_data??{}).join(`
`)},r=(p,{json:g}={})=>{const m=e.apiIntegration({definitionId:"Crowdstrike alerts and message-center",operationId:p}),f=A=>m.execute({request:{[g?"json":"params"]:A}}),h=A=>A?.resources?.[0]?.response_body?.resources??[];return{get:A=>f(A).then(E=>h(E)?.[0]??{}),list:A=>f(A).then(h)}};return{getDetectionById:t,getCollectionData:s,getDetectionComments:o,translateHtml:n,data:{...e.data,detectionId:e.data?.detectionId??e.data?.detection?.composite_id}}},ci=()=>new Promise(a=>setTimeout(a,ss));class is extends Error{constructor(){super("Max polling attempts for workflow completion")}}/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:as,setPrototypeOf:$t,isFrozen:pi,getPrototypeOf:li,getOwnPropertyDescriptor:di}=Object;let{freeze:I,seal:F,create:os}=Object,{apply:lt,construct:dt}=typeof Reflect<"u"&&Reflect;I||(I=function(e){return e});F||(F=function(e){return e});lt||(lt=function(e,t,s){return e.apply(t,s)});dt||(dt=function(e,t){return new e(...t)});const xe=C(Array.prototype.forEach),gi=C(Array.prototype.lastIndexOf),qt=C(Array.prototype.pop),fe=C(Array.prototype.push),ui=C(Array.prototype.splice),Ne=C(String.prototype.toLowerCase),ot=C(String.prototype.toString),Kt=C(String.prototype.match),be=C(String.prototype.replace),mi=C(String.prototype.indexOf),hi=C(String.prototype.trim),H=C(Object.prototype.hasOwnProperty),O=C(RegExp.prototype.test),Ee=yi(TypeError);function C(a){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];return lt(a,e,s)}}function yi(a){return function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return dt(a,t)}}function u(a,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ne;$t&&$t(a,null);let s=e.length;for(;s--;){let o=e[s];if(typeof o=="string"){const n=t(o);n!==o&&(pi(e)||(e[s]=n),o=n)}a[o]=!0}return a}function fi(a){for(let e=0;e<a.length;e++)H(a,e)||(a[e]=null);return a}function $(a){const e=os(null);for(const[t,s]of as(a))H(a,t)&&(Array.isArray(s)?e[t]=fi(s):s&&typeof s=="object"&&s.constructor===Object?e[t]=$(s):e[t]=s);return e}function Ae(a,e){for(;a!==null;){const s=di(a,e);if(s){if(s.get)return C(s.get);if(typeof s.value=="function")return C(s.value)}a=li(a)}function t(){return null}return t}const Yt=I(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),nt=I(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),rt=I(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),bi=I(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ct=I(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ei=I(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Xt=I(["#text"]),Zt=I(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),pt=I(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Jt=I(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Pe=I(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ai=F(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ti=F(/<%[\w\W]*|[\w\W]*%>/gm),wi=F(/\$\{[\w\W]*/gm),Mi=F(/^data-[\-\w.\u00B7-\uFFFF]+$/),_i=F(/^aria-[\-\w]+$/),ns=F(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),vi=F(/^(?:\w+script|data):/i),Vi=F(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),rs=F(/^html$/i),Si=F(/^[a-z][.\w]*(-[.\w]+)+$/i);var es=Object.freeze({__proto__:null,ARIA_ATTR:_i,ATTR_WHITESPACE:Vi,CUSTOM_ELEMENT:Si,DATA_ATTR:Mi,DOCTYPE_NAME:rs,ERB_EXPR:Ti,IS_ALLOWED_URI:ns,IS_SCRIPT_OR_DATA:vi,MUSTACHE_EXPR:Ai,TMPLIT_EXPR:wi});const Te={element:1,text:3,progressingInstruction:7,comment:8,document:9},Ri=function(){return typeof window>"u"?null:window},Di=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let s=null;const o="data-tt-policy-suffix";t&&t.hasAttribute(o)&&(s=t.getAttribute(o));const n="dompurify"+(s?"#"+s:"");try{return e.createPolicy(n,{createHTML(r){return r},createScriptURL(r){return r}})}catch{return console.warn("TrustedTypes policy "+n+" could not be created."),null}},ts=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function cs(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ri();const e=d=>cs(d);if(e.version="3.2.6",e.removed=[],!a||!a.document||a.document.nodeType!==Te.document||!a.Element)return e.isSupported=!1,e;let{document:t}=a;const s=t,o=s.currentScript,{DocumentFragment:n,HTMLTemplateElement:r,Node:p,Element:g,NodeFilter:m,NamedNodeMap:f=a.NamedNodeMap||a.MozNamedAttrMap,HTMLFormElement:h,DOMParser:A,trustedTypes:E}=a,N=g.prototype,G=Ae(N,"cloneNode"),Y=Ae(N,"remove"),ps=Ae(N,"nextSibling"),ls=Ae(N,"childNodes"),Me=Ae(N,"parentNode");if(typeof r=="function"){const d=t.createElement("template");d.content&&d.content.ownerDocument&&(t=d.content.ownerDocument)}let D,ge="";const{implementation:Be,createNodeIterator:ds,createDocumentFragment:gs,getElementsByTagName:us}=t,{importNode:ms}=s;let L=ts();e.isSupported=typeof as=="function"&&typeof Me=="function"&&Be&&Be.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ze,ERB_EXPR:je,TMPLIT_EXPR:We,DATA_ATTR:hs,ARIA_ATTR:ys,IS_SCRIPT_OR_DATA:fs,ATTR_WHITESPACE:mt,CUSTOM_ELEMENT:bs}=es;let{IS_ALLOWED_URI:ht}=es,w=null;const yt=u({},[...Yt,...nt,...rt,...ct,...Xt]);let v=null;const ft=u({},[...Zt,...pt,...Jt,...Pe]);let b=Object.seal(os(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ue=null,Qe=null,bt=!0,$e=!0,Et=!1,At=!0,se=!1,_e=!0,X=!1,qe=!1,Ke=!1,ie=!1,ve=!1,Ve=!1,Tt=!0,wt=!1;const Es="user-content-";let Ye=!0,me=!1,ae={},oe=null;const Mt=u({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let _t=null;const vt=u({},["audio","video","img","source","image","track"]);let Xe=null;const Vt=u({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Se="http://www.w3.org/1998/Math/MathML",Re="http://www.w3.org/2000/svg",j="http://www.w3.org/1999/xhtml";let ne=j,Ze=!1,Je=null;const As=u({},[Se,Re,j],ot);let De=u({},["mi","mo","mn","ms","mtext"]),Le=u({},["annotation-xml"]);const Ts=u({},["title","style","font","a","script"]);let he=null;const ws=["application/xhtml+xml","text/html"],Ms="text/html";let M=null,re=null;const _s=t.createElement("form"),St=function(i){return i instanceof RegExp||i instanceof Function},et=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(re&&re===i)){if((!i||typeof i!="object")&&(i={}),i=$(i),he=ws.indexOf(i.PARSER_MEDIA_TYPE)===-1?Ms:i.PARSER_MEDIA_TYPE,M=he==="application/xhtml+xml"?ot:Ne,w=H(i,"ALLOWED_TAGS")?u({},i.ALLOWED_TAGS,M):yt,v=H(i,"ALLOWED_ATTR")?u({},i.ALLOWED_ATTR,M):ft,Je=H(i,"ALLOWED_NAMESPACES")?u({},i.ALLOWED_NAMESPACES,ot):As,Xe=H(i,"ADD_URI_SAFE_ATTR")?u($(Vt),i.ADD_URI_SAFE_ATTR,M):Vt,_t=H(i,"ADD_DATA_URI_TAGS")?u($(vt),i.ADD_DATA_URI_TAGS,M):vt,oe=H(i,"FORBID_CONTENTS")?u({},i.FORBID_CONTENTS,M):Mt,ue=H(i,"FORBID_TAGS")?u({},i.FORBID_TAGS,M):$({}),Qe=H(i,"FORBID_ATTR")?u({},i.FORBID_ATTR,M):$({}),ae=H(i,"USE_PROFILES")?i.USE_PROFILES:!1,bt=i.ALLOW_ARIA_ATTR!==!1,$e=i.ALLOW_DATA_ATTR!==!1,Et=i.ALLOW_UNKNOWN_PROTOCOLS||!1,At=i.ALLOW_SELF_CLOSE_IN_ATTR!==!1,se=i.SAFE_FOR_TEMPLATES||!1,_e=i.SAFE_FOR_XML!==!1,X=i.WHOLE_DOCUMENT||!1,ie=i.RETURN_DOM||!1,ve=i.RETURN_DOM_FRAGMENT||!1,Ve=i.RETURN_TRUSTED_TYPE||!1,Ke=i.FORCE_BODY||!1,Tt=i.SANITIZE_DOM!==!1,wt=i.SANITIZE_NAMED_PROPS||!1,Ye=i.KEEP_CONTENT!==!1,me=i.IN_PLACE||!1,ht=i.ALLOWED_URI_REGEXP||ns,ne=i.NAMESPACE||j,De=i.MATHML_TEXT_INTEGRATION_POINTS||De,Le=i.HTML_INTEGRATION_POINTS||Le,b=i.CUSTOM_ELEMENT_HANDLING||{},i.CUSTOM_ELEMENT_HANDLING&&St(i.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(b.tagNameCheck=i.CUSTOM_ELEMENT_HANDLING.tagNameCheck),i.CUSTOM_ELEMENT_HANDLING&&St(i.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(b.attributeNameCheck=i.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),i.CUSTOM_ELEMENT_HANDLING&&typeof i.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(b.allowCustomizedBuiltInElements=i.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),se&&($e=!1),ve&&(ie=!0),ae&&(w=u({},Xt),v=[],ae.html===!0&&(u(w,Yt),u(v,Zt)),ae.svg===!0&&(u(w,nt),u(v,pt),u(v,Pe)),ae.svgFilters===!0&&(u(w,rt),u(v,pt),u(v,Pe)),ae.mathMl===!0&&(u(w,ct),u(v,Jt),u(v,Pe))),i.ADD_TAGS&&(w===yt&&(w=$(w)),u(w,i.ADD_TAGS,M)),i.ADD_ATTR&&(v===ft&&(v=$(v)),u(v,i.ADD_ATTR,M)),i.ADD_URI_SAFE_ATTR&&u(Xe,i.ADD_URI_SAFE_ATTR,M),i.FORBID_CONTENTS&&(oe===Mt&&(oe=$(oe)),u(oe,i.FORBID_CONTENTS,M)),Ye&&(w["#text"]=!0),X&&u(w,["html","head","body"]),w.table&&(u(w,["tbody"]),delete ue.tbody),i.TRUSTED_TYPES_POLICY){if(typeof i.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ee('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof i.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ee('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');D=i.TRUSTED_TYPES_POLICY,ge=D.createHTML("")}else D===void 0&&(D=Di(E,o)),D!==null&&typeof ge=="string"&&(ge=D.createHTML(""));I&&I(i),re=i}},Rt=u({},[...nt,...rt,...bi]),Dt=u({},[...ct,...Ei]),vs=function(i){let c=Me(i);(!c||!c.tagName)&&(c={namespaceURI:ne,tagName:"template"});const l=Ne(i.tagName),y=Ne(c.tagName);return Je[i.namespaceURI]?i.namespaceURI===Re?c.namespaceURI===j?l==="svg":c.namespaceURI===Se?l==="svg"&&(y==="annotation-xml"||De[y]):!!Rt[l]:i.namespaceURI===Se?c.namespaceURI===j?l==="math":c.namespaceURI===Re?l==="math"&&Le[y]:!!Dt[l]:i.namespaceURI===j?c.namespaceURI===Re&&!Le[y]||c.namespaceURI===Se&&!De[y]?!1:!Dt[l]&&(Ts[l]||!Rt[l]):!!(he==="application/xhtml+xml"&&Je[i.namespaceURI]):!1},B=function(i){fe(e.removed,{element:i});try{Me(i).removeChild(i)}catch{Y(i)}},ce=function(i,c){try{fe(e.removed,{attribute:c.getAttributeNode(i),from:c})}catch{fe(e.removed,{attribute:null,from:c})}if(c.removeAttribute(i),i==="is")if(ie||ve)try{B(c)}catch{}else try{c.setAttribute(i,"")}catch{}},Lt=function(i){let c=null,l=null;if(Ke)i="<remove></remove>"+i;else{const T=Kt(i,/^[\r\n\t ]+/);l=T&&T[0]}he==="application/xhtml+xml"&&ne===j&&(i='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+i+"</body></html>");const y=D?D.createHTML(i):i;if(ne===j)try{c=new A().parseFromString(y,he)}catch{}if(!c||!c.documentElement){c=Be.createDocument(ne,"template",null);try{c.documentElement.innerHTML=Ze?ge:y}catch{}}const S=c.body||c.documentElement;return i&&l&&S.insertBefore(t.createTextNode(l),S.childNodes[0]||null),ne===j?us.call(c,X?"html":"body")[0]:X?c.documentElement:S},Ot=function(i){return ds.call(i.ownerDocument||i,i,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},tt=function(i){return i instanceof h&&(typeof i.nodeName!="string"||typeof i.textContent!="string"||typeof i.removeChild!="function"||!(i.attributes instanceof f)||typeof i.removeAttribute!="function"||typeof i.setAttribute!="function"||typeof i.namespaceURI!="string"||typeof i.insertBefore!="function"||typeof i.hasChildNodes!="function")},It=function(i){return typeof p=="function"&&i instanceof p};function W(d,i,c){xe(d,l=>{l.call(e,i,c,re)})}const Ct=function(i){let c=null;if(W(L.beforeSanitizeElements,i,null),tt(i))return B(i),!0;const l=M(i.nodeName);if(W(L.uponSanitizeElement,i,{tagName:l,allowedTags:w}),_e&&i.hasChildNodes()&&!It(i.firstElementChild)&&O(/<[/\w!]/g,i.innerHTML)&&O(/<[/\w!]/g,i.textContent)||i.nodeType===Te.progressingInstruction||_e&&i.nodeType===Te.comment&&O(/<[/\w]/g,i.data))return B(i),!0;if(!w[l]||ue[l]){if(!ue[l]&&Pt(l)&&(b.tagNameCheck instanceof RegExp&&O(b.tagNameCheck,l)||b.tagNameCheck instanceof Function&&b.tagNameCheck(l)))return!1;if(Ye&&!oe[l]){const y=Me(i)||i.parentNode,S=ls(i)||i.childNodes;if(S&&y){const T=S.length;for(let k=T-1;k>=0;--k){const Q=G(S[k],!0);Q.__removalCount=(i.__removalCount||0)+1,y.insertBefore(Q,ps(i))}}}return B(i),!0}return i instanceof g&&!vs(i)||(l==="noscript"||l==="noembed"||l==="noframes")&&O(/<\/no(script|embed|frames)/i,i.innerHTML)?(B(i),!0):(se&&i.nodeType===Te.text&&(c=i.textContent,xe([ze,je,We],y=>{c=be(c,y," ")}),i.textContent!==c&&(fe(e.removed,{element:i.cloneNode()}),i.textContent=c)),W(L.afterSanitizeElements,i,null),!1)},xt=function(i,c,l){if(Tt&&(c==="id"||c==="name")&&(l in t||l in _s))return!1;if(!($e&&!Qe[c]&&O(hs,c))){if(!(bt&&O(ys,c))){if(!v[c]||Qe[c]){if(!(Pt(i)&&(b.tagNameCheck instanceof RegExp&&O(b.tagNameCheck,i)||b.tagNameCheck instanceof Function&&b.tagNameCheck(i))&&(b.attributeNameCheck instanceof RegExp&&O(b.attributeNameCheck,c)||b.attributeNameCheck instanceof Function&&b.attributeNameCheck(c))||c==="is"&&b.allowCustomizedBuiltInElements&&(b.tagNameCheck instanceof RegExp&&O(b.tagNameCheck,l)||b.tagNameCheck instanceof Function&&b.tagNameCheck(l))))return!1}else if(!Xe[c]){if(!O(ht,be(l,mt,""))){if(!((c==="src"||c==="xlink:href"||c==="href")&&i!=="script"&&mi(l,"data:")===0&&_t[i])){if(!(Et&&!O(fs,be(l,mt,"")))){if(l)return!1}}}}}}return!0},Pt=function(i){return i!=="annotation-xml"&&Kt(i,bs)},Nt=function(i){W(L.beforeSanitizeAttributes,i,null);const{attributes:c}=i;if(!c||tt(i))return;const l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:v,forceKeepAttr:void 0};let y=c.length;for(;y--;){const S=c[y],{name:T,namespaceURI:k,value:Q}=S,ye=M(T),st=Q;let R=T==="value"?st:hi(st);if(l.attrName=ye,l.attrValue=R,l.keepAttr=!0,l.forceKeepAttr=void 0,W(L.uponSanitizeAttribute,i,l),R=l.attrValue,wt&&(ye==="id"||ye==="name")&&(ce(T,i),R=Es+R),_e&&O(/((--!?|])>)|<\/(style|title)/i,R)){ce(T,i);continue}if(l.forceKeepAttr)continue;if(!l.keepAttr){ce(T,i);continue}if(!At&&O(/\/>/i,R)){ce(T,i);continue}se&&xe([ze,je,We],Ut=>{R=be(R,Ut," ")});const kt=M(i.nodeName);if(!xt(kt,ye,R)){ce(T,i);continue}if(D&&typeof E=="object"&&typeof E.getAttributeType=="function"&&!k)switch(E.getAttributeType(kt,ye)){case"TrustedHTML":{R=D.createHTML(R);break}case"TrustedScriptURL":{R=D.createScriptURL(R);break}}if(R!==st)try{k?i.setAttributeNS(k,T,R):i.setAttribute(T,R),tt(i)?B(i):qt(e.removed)}catch{ce(T,i)}}W(L.afterSanitizeAttributes,i,null)},Vs=function d(i){let c=null;const l=Ot(i);for(W(L.beforeSanitizeShadowDOM,i,null);c=l.nextNode();)W(L.uponSanitizeShadowNode,c,null),Ct(c),Nt(c),c.content instanceof n&&d(c.content);W(L.afterSanitizeShadowDOM,i,null)};return e.sanitize=function(d){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=null,l=null,y=null,S=null;if(Ze=!d,Ze&&(d="<!-->"),typeof d!="string"&&!It(d))if(typeof d.toString=="function"){if(d=d.toString(),typeof d!="string")throw Ee("dirty is not a string, aborting")}else throw Ee("toString is not a function");if(!e.isSupported)return d;if(qe||et(i),e.removed=[],typeof d=="string"&&(me=!1),me){if(d.nodeName){const Q=M(d.nodeName);if(!w[Q]||ue[Q])throw Ee("root node is forbidden and cannot be sanitized in-place")}}else if(d instanceof p)c=Lt("<!---->"),l=c.ownerDocument.importNode(d,!0),l.nodeType===Te.element&&l.nodeName==="BODY"||l.nodeName==="HTML"?c=l:c.appendChild(l);else{if(!ie&&!se&&!X&&d.indexOf("<")===-1)return D&&Ve?D.createHTML(d):d;if(c=Lt(d),!c)return ie?null:Ve?ge:""}c&&Ke&&B(c.firstChild);const T=Ot(me?d:c);for(;y=T.nextNode();)Ct(y),Nt(y),y.content instanceof n&&Vs(y.content);if(me)return d;if(ie){if(ve)for(S=gs.call(c.ownerDocument);c.firstChild;)S.appendChild(c.firstChild);else S=c;return(v.shadowroot||v.shadowrootmode)&&(S=ms.call(s,S,!0)),S}let k=X?c.outerHTML:c.innerHTML;return X&&w["!doctype"]&&c.ownerDocument&&c.ownerDocument.doctype&&c.ownerDocument.doctype.name&&O(rs,c.ownerDocument.doctype.name)&&(k="<!DOCTYPE "+c.ownerDocument.doctype.name+`>
`+k),se&&xe([ze,je,We],Q=>{k=be(k,Q," ")}),D&&Ve?D.createHTML(k):k},e.setConfig=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};et(d),qe=!0},e.clearConfig=function(){re=null,qe=!1},e.isValidAttribute=function(d,i,c){re||et({});const l=M(d),y=M(i);return xt(l,y,c)},e.addHook=function(d,i){typeof i=="function"&&fe(L[d],i)},e.removeHook=function(d,i){if(i!==void 0){const c=gi(L[d],i);return c===-1?void 0:ui(L[d],c,1)[0]}return qt(L[d])},e.removeHooks=function(d){L[d]=[]},e.removeAllHooks=function(){L=ts()},e}var Li=cs();const z=Li.sanitize,ee=({title:a,content:e})=>`<div class="space-y-2 rounded bg-surface-md p-3 shadow-base">
      <header class="type-md-tight-medium overflow-hidden text-titles-and-attributes">
        ${z(a)}
      </header>
      <div class="type-md min-h-6 text-titles-and-attributes">
        ${z(e)}
      </div>
    </div>`,Oi=({created_by:{display_name:a},created_time:e,body:t})=>`
  <li class="grid gap-1">
    <div class="font-semibold text-gray-900">
        ${z(a)} on ${z(e)}
    </div>
    ${z(t)}
  </li>`,Ii=(a,e=[])=>{const{description:t,overwatch_note:s,overwatch_note_timestamp:o,automated_triage:n}=a,{triage_explanation:r}=n??{},p=s?`
    <div class="grid gap-1">
      <dt class="font-semibold text-gray-900">
        Overwatch notes ${o?"("+z(o)+")":""}
      </dt>
      <dd class="text-gray-600">
        ${z(s)}
      </dd>
    </div>
  `:"";let g=`
  <dl class="space-y-6">  
    <div class="grid gap-1">
      <dt class="font-semibold text-gray-900">Description</dt>
      <dd class="text-gray-600">
        ${z(t)}
      </dd>
    </div>

    ${p}
      
    <div class="grid gap-1">
      <dt class="font-semibold text-gray-900">AI Triage</dt>
      <dd class="text-gray-600">
        ${z(r)}
      </dd>
    </div>
  </dl>
`;return e.length&&(g+=`
    <div class="mt-6">
      <h2 class="font-semibold text-gray-900">Falcon complete</h2> 
      <h3 class="font-semibold text-gray-900 text-sm">Comments</h3> 
      <ul class="space-y-6">
        ${e.map(Oi).map(z).join(`
`)}
      </ul>
    </div>`),g};async function Ci({detectionId:a,language:e,collectionEntry:t,domSlots:s,falconService:o}){const{title:n,type:r,objectKey:p}=t,{getDetectionById:g,getDetectionComments:m,translateHtml:f}=o;try{s.translationSlot.innerHTML=ee({title:"Translation in progress...",content:"Your translation is being processed. This may take a few moments depending on content size"});const h=await g(a),A=await m(a),E=Ii(h,A),N=await f({language:e,htmlContent:E,collectionEntry:t});s.translationSlot.innerHTML=ee({title:n,content:N??E})}catch(h){if(h instanceof is)return await gt({detectionId:a,domSlots:s,language:e,falconService:o});console.error("Error processing detection:",h),s.translationSlot.innerHTML=`
      <div class="p-4 bg-red-100 border border-red-400 text-red-700  rounded">
        Error translating detection: ${h.message}
      </div>
    `}}async function gt({detectionId:a,domSlots:e,language:t,falconService:s}){let o=[];const{getCollectionData:n}=s,{translationSlot:r,contextSlot:p}=e;try{r.innerHTML="",p.innerHTML=ee({title:"",content:"Loading detection context..."}),o=await n(a);const g=a.replace(/[^\w\-\.]/g,""),m=`Detection translation (${t})`,f=`translation_${t}`,h=`${g}_${f}`,A=o.find(({object_key:Y})=>Y===h);let E="";A?E=ee(A):t==="en"?E=ee({title:m,content:"Your browser language is already configured in English. No translation needed."}):E=ee({title:m,content:`
        <div>
          <p>There is no yet translation available for this detection. Click in the button to get an AI translation of the detection details.<p>
          <p>The translation will use Charlotte AI credit</p>
          <button id="translateBtn"  
            class="focusable interactive-normal type-md-medium rounded-sm my-2 py-1 px-3 transition duration-150 ease-in-out focusable transition">
            Translate detection details
          </button>
        </div>`}),r.innerHTML=E;const N=o.filter(({object_key:Y})=>Y!==h);p.innerHTML=N.map(ee).join("");const G=document.getElementById("translateBtn");if(G){const Y={title:m,type:f,objectKey:h,compositeId:a};G.addEventListener("click",()=>Ci({detectionId:a,language:t,collectionEntry:Y,falconService:s,domSlots:e}))}}catch(g){console.error("Error processing detection:",g),r.innerHTML=`
      <div class="p-4 bg-red-100 border border-red-400 text-red-700  rounded">
        Error processing detection: ${g.message}
      </div>
    `}return{entries:o,language:t}}async function xi(){let a;const e={translationSlot:document.getElementById("translationSlot"),contextSlot:document.getElementById("contextSlot")},t=navigator.language?navigator.language.toLowerCase().split("-")[0]:"en",s=r=>{a&&r&&a!==r&&gt({detectionId:r,language:t,domSlots:e,falconService:n})},{data:o,...n}=await ri(s);a=o.detectionId,await gt({detectionId:a,language:t,domSlots:e,falconService:n})}typeof window<"u"&&xi();
//# sourceMappingURL=app.js.map
